import{br as j,r as _,bo as t,bU as h,bV as T,bW as I,bX as M,bY as b}from"./vendor-BO8aFb6R.js";import{a as z}from"./vendor_tanstack-Croh7sPd.js";import{u as R,f as c,p as v,q as F,t as S}from"./index-ousJY6BN.js";import{u}from"./useApiMutation-UX_6QUDT.js";import{p as $,q as o,a as q,B as m,P as w,T as C,f as H,n as r}from"./vendor_antd-DBq17MzT.js";const{Title:K}=C,U=()=>{const{t:e}=j(),{setPageTitle:i,timezone:d}=R();_.useEffect(()=>{i(e("task_management","Керування завданнями"))},[i,e]);const n=["tasks"],{data:l={tasks:[],total:0},isLoading:p,isFetching:x}=z({queryKey:n,queryFn:()=>S(100,0),refetchInterval:5e3}),{mutate:y}=u({mutationFn:v,successMessage:e("task_deleted","Завдання видалено"),errorMessage:e("task_delete_error","Помилка видалення завдання"),invalidateQueryKeys:[n]}),{mutate:g}=u({mutationFn:s=>F(s,"pending"),successMessage:e("task_restarted","Завдання перезапущено"),errorMessage:e("task_restart_error","Помилка перезапуску завдання"),invalidateQueryKeys:[n]}),k=s=>{switch(s){case"completed":return t.jsx(r,{icon:t.jsx(b,{}),color:"success",children:e("completed","Завершено")});case"failed":return t.jsx(r,{icon:t.jsx(M,{}),color:"error",children:e("failed","Помилка")});case"pending":case"running":return t.jsx(r,{icon:t.jsx(I,{spin:!0}),color:"processing",children:e(s,s==="pending"?"Очікування":"Виконується")});default:return t.jsx(r,{children:s})}},f=[{title:e("name","Назва"),dataIndex:"name",key:"name",render:(s,a)=>s||`Сканування ${a.id}`},{title:e("status","Статус"),dataIndex:"status",key:"status",render:s=>k(s)},{title:e("progress","Прогрес"),dataIndex:"progress",key:"progress",render:s=>t.jsx($,{percent:s,size:"small"})},{title:e("created_at","Створено"),dataIndex:"created_at",key:"created_at",render:s=>c(s,d,"dd.MM.yyyy HH:mm:ss")},{title:e("updated_at","Оновлено"),dataIndex:"updated_at",key:"updated_at",render:s=>c(s,d,"dd.MM.yyyy HH:mm:ss")},{title:e("error","Помилка"),dataIndex:"error",key:"error",render:s=>s?t.jsx(o,{title:s,children:t.jsx("span",{style:{color:"red"},children:e("yes","Так")})}):e("no","Ні")},{title:e("actions","Дії"),key:"actions",render:(s,a)=>t.jsxs(q,{children:[a.status==="failed"&&t.jsx(o,{title:e("retry_task","Перезапустити завдання"),children:t.jsx(m,{icon:t.jsx(h,{}),onClick:()=>g(a.id),size:"small"})}),t.jsx(w,{title:e("confirm_delete_task","Ви впевнені, що хочете видалити завдання?"),onConfirm:()=>y(a.id),okText:e("yes","Так"),cancelText:e("no","Ні"),children:t.jsx(o,{title:e("delete_task","Видалити завдання"),children:t.jsx(m,{icon:t.jsx(T,{}),danger:!0,size:"small"})})})]})}];return t.jsxs("div",{style:{padding:"16px 24px"},children:[t.jsx(K,{level:2,children:e("task_management","Керування завданнями")}),t.jsx(H,{dataSource:l.tasks,columns:f,rowKey:"id",loading:p||x,pagination:{total:l.total,showSizeChanger:!1},size:"middle"})]})};export{U as default};
