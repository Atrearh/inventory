import{br as b,bo as s,r as x}from"./vendor-BO8aFb6R.js";import{a as S,c as M}from"./vendor_tanstack-Croh7sPd.js";import{u as F,f as _,r as A,i as q,j as w,h as y,c as k}from"./index-ousJY6BN.js";import{u as j}from"./useApiMutation-UX_6QUDT.js";import{n as f,P as v,B as p,C,a as K,T as E,f as P,F as i,S as B,i as R,o as z,h as L,s as T}from"./vendor_antd-DBq17MzT.js";const{Title:Q,Text:V}=E,D=()=>{const{t:e}=b(),{timezone:a}=F(),r=["sessions"],{data:g,isLoading:u}=S({queryKey:r,queryFn:w}),{mutate:m,isPending:o}=j({mutationFn:A,successMessage:e("session_revoked"),errorMessage:e("session_revoke_error"),invalidateQueryKeys:[r]}),{mutate:l,isPending:h}=j({mutationFn:q,successMessage:e("all_other_sessions_revoked"),errorMessage:e("session_revoke_error"),invalidateQueryKeys:[r]}),c=[{title:e("login_date"),dataIndex:"issued_at",key:"issued_at",render:n=>_(n,a)},{title:e("session_expires"),dataIndex:"expires_at",key:"expires_at",render:n=>_(n,a)},{title:e("status"),dataIndex:"is_current",key:"is_current",render:n=>n?s.jsx(f,{color:"green",children:e("current_session")}):s.jsx(f,{color:"default",children:e("active")})},{title:e("actions"),key:"actions",render:(n,d)=>!d.is_current&&s.jsx(v,{title:e("confirm_revoke_session"),onConfirm:()=>m(d.id),okText:e("yes"),cancelText:e("no"),children:s.jsx(p,{danger:!0,loading:o,children:e("revoke")})})}];return s.jsx(C,{children:s.jsxs(K,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Q,{level:4,children:e("session_management")}),s.jsx(V,{type:"secondary",children:e("session_management_description")}),s.jsx(v,{title:e("confirm_revoke_all_other_sessions"),onConfirm:()=>l(),okText:e("yes"),cancelText:e("no"),children:s.jsx(p,{danger:!0,loading:h,style:{marginBottom:16},children:e("revoke_all_other_sessions")})}),s.jsx(P,{columns:c,dataSource:g,rowKey:"id",loading:u,pagination:!1})]})})},{Title:O}=E,J=()=>{const{t:e}=b(),[a]=i.useForm(),{language:r,changeLanguage:g,dark:u,toggleTheme:m,setPageTitle:o}=F();x.useEffect(()=>{o(e("settings","Налаштування"))},[o,e]);const{data:l,isLoading:h,error:c}=S({queryKey:["settings"],queryFn:async()=>(await k("get","/settings")).data}),n=M({mutationFn:async t=>await k("post","/settings",t),onSuccess:()=>{T.success(e("settings_updated","Налаштування успішно оновлено!"))},onError:t=>{const I=y(t,e,e("error_updating_settings","Помилка оновлення налаштувань"));T.error(I.message)}});if(x.useEffect(()=>{l&&a.setFieldsValue({language:r})},[l,r,a]),h)return s.jsx(B,{size:"large",style:{display:"block",margin:"50px auto"}});if(c){const t=y(c,e,e("error_loading_settings","Помилка завантаження налаштувань"));return s.jsxs("div",{children:[e("error_loading_settings","Помилка завантаження налаштувань"),":"," ",t.message]})}const d=[{key:"general",label:e("general_settings","Загальні налаштування"),children:s.jsxs(i,{form:a,layout:"vertical",onFinish:t=>{t.language&&g(t.language),n.mutate(t)},style:{maxWidth:400},children:[s.jsx(i.Item,{label:e("language","Мова"),name:"language",initialValue:r,rules:[{required:!0,message:e("select_language","Будь ласка, оберіть мову")}],tooltip:e("language_tooltip","Виберіть мову інтерфейсу системи."),children:s.jsx(R,{placeholder:e("select_language","Оберіть мову"),options:[{value:"uk",label:"Українська"},{value:"en",label:"English"}]})}),s.jsx(i.Item,{label:e("theme","Тема"),tooltip:e("theme_tooltip","Виберіть темну або світлу тему інтерфейсу."),children:s.jsx(z,{checked:u,onChange:m,checkedChildren:e("dark","Темна"),unCheckedChildren:e("light","Світла")})}),s.jsx(i.Item,{children:s.jsx(p,{type:"primary",htmlType:"submit",loading:n.isPending,children:e("save","Зберегти")})})]})},{key:"security",label:e("security","Безпека"),children:s.jsx(D,{})}];return s.jsx("div",{style:{padding:"24px"},children:s.jsxs(C,{children:[s.jsx(O,{level:3,style:{marginBottom:24},children:e("settings","Налаштування")}),s.jsx(L,{defaultActiveKey:"general",items:d})]})})};export{J as default};
